import{j as e}from"./app.6LWIl6Tz.js";import{d as t,H as s,L as a,f as l}from"./vendor.Dilc0e1Z.js";function r({registrations:r,event:i,teams_count:n}){const[d,o]=t.useState(null),[c,m]=t.useState(r),[p,x]=t.useState(!1),[u,h]=t.useState({isOpen:!1,playerId:null,playerEmail:null,action:null}),[b,f]=t.useState(""),g=t.useMemo(()=>{const e=b.trim().toLowerCase();return e?c.map(t=>({...t,players:t.players.filter(s=>(t.team_name||"").toLowerCase().includes(e)||s.name.toLowerCase().includes(e)||(s.email||"").toLowerCase().includes(e)||(s.student_id||"").toLowerCase().includes(e))})).filter(t=>t.players.length>0||(t.team_name||"").toLowerCase().includes(e)):c},[c,b]),y=e=>{const t=(e||"Pending").toLowerCase(),s="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium";return"approved"===t?`${s} bg-green-500/20 text-green-300 border border-green-400/30`:"disapproved"===t?`${s} bg-red-500/20 text-red-300 border border-red-400/30`:`${s} bg-yellow-500/20 text-yellow-200 border border-yellow-400/30`},j=(e,t,s)=>{const a=c.flatMap(e=>e.players).find(t=>t.id===e);if(a){const l=a.statusUpdatedAt&&new Date-new Date(a.statusUpdatedAt)<1e4;!l&&a.status&&"Pending"!==a.status||h({isOpen:!0,playerId:e,playerEmail:t,action:s,isUndo:l})}},w=()=>{h(e=>({...e,isOpen:!1}))};return e.jsxs(e.Fragment,{children:[e.jsx(s,{title:"Registered Teams"}),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-blue-950 to-black text-slate-100 py-10 px-4",children:[e.jsx(a,{href:route("dashboard"),className:"relative\n                                            text-[14px] font-extrabold font-inherit uppercase\n                                            text-[#e1e1e1]\n                                            cursor-pointer bg-none border-0\n                                            transition-colors duration-400 [transition-timing-function:cubic-bezier(0.25,0.8,0.25,1)]\n                                            hover:text-white focus:text-white\n                                            after:content-[''] after:absolute after:bottom-[-2px] after:left-1/2\n                                            after:w-0 after:h-[2px] after:bg-white\n                                            after:transition-[width,left] after:duration-400 [after:transition-timing-function:cubic-bezier(0.25,0.8,0.25,1)]\n                                            hover:after:w-full hover:after:left-0\n                                            focus:after:w-full focus:after:left-0\n                                            h-15 px-2 mt-10",children:"← Back to dashboard"}),e.jsxs("div",{className:"mx-auto w-full max-w-6xl overflow-hidden rounded-xl shadow-2xl border border-white/15 bg-white/10 backdrop-blur-xl p-6 sm:p-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-semibold",children:["Registered Teams",i?.title?` — ${i.title}`:""]}),e.jsxs("p",{className:"text-slate-300",children:[n??c.length," team(s) registered"]})]}),e.jsxs("div",{className:"w-full sm:w-80",children:[e.jsx("label",{className:"block text-sm mb-1 text-slate-300",children:"Search teams or players"}),e.jsx("input",{type:"text",value:b,onChange:e=>f(e.target.value),placeholder:"Search by team, name, email or student ID",className:"w-full bg-white/10 border border-white/20 text-slate-100 placeholder-slate-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500/40"})]})]}),e.jsx("div",{className:"mt-6",children:0===g.length?e.jsx("p",{className:"text-slate-300",children:"No teams match your search."}):e.jsx("div",{className:"space-y-8",children:g.map(t=>e.jsxs("div",{className:"border border-white/15 rounded bg-white/5 p-4",children:[e.jsxs("h2",{className:"font-bold text-lg mb-3",children:["Team: ",t.team_name||`Team of ${t.players.map(e=>e.name).join(", ")}`]}),e.jsx("div",{className:"overflow-x-auto rounded border border-white/10",children:e.jsxs("table",{className:"w-full table-auto",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-white/10 text-slate-200",children:[e.jsx("th",{className:"px-3 py-2 text-left text-sm font-semibold",children:"#"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm font-semibold",children:"Name"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm font-semibold",children:"Email"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm font-semibold",children:"Student ID"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm font-semibold",children:"Department"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm font-semibold",children:"Age"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm font-semibold",children:"Player Image"}),e.jsx("th",{className:"px-3 py-2 text-left text-sm font-semibold",children:"Whiteform Image"}),e.jsx("th",{className:"px-3 py-2 text-center text-sm font-semibold",children:"Status"}),e.jsx("th",{className:"px-3 py-2 text-center text-sm font-semibold",children:"Actions"})]})}),e.jsx("tbody",{children:t.players.map((t,s)=>e.jsxs("tr",{className:"odd:bg-white/0 even:bg-white/5",children:[e.jsx("td",{className:"px-3 py-2 align-middle text-center",children:s+1}),e.jsx("td",{className:"px-3 py-2 align-middle",children:t.name}),e.jsx("td",{className:"px-3 py-2 align-middle",children:t.email}),e.jsx("td",{className:"px-3 py-2 align-middle",children:t.student_id}),e.jsx("td",{className:"px-3 py-2 align-middle",children:t.department}),e.jsx("td",{className:"px-3 py-2 align-middle",children:t.age}),e.jsx("td",{className:"px-3 py-2 align-middle text-center",children:t.player_image&&e.jsx("img",{src:`data:image/*;base64,${t.player_image}`,alt:"Player",className:"h-16 w-16 object-cover rounded cursor-pointer hover:scale-110 transition",onClick:()=>o(`data:image/jpeg;base64,${t.player_image}`)})}),e.jsx("td",{className:"px-3 py-2 align-middle text-center",children:t.whiteform_image&&e.jsx("img",{src:`data:image/*;base64,${t.whiteform_image}`,alt:"Whiteform",className:"h-16 w-16 object-cover rounded cursor-pointer hover:scale-110 transition",onClick:()=>o(`data:image/jpeg;base64,${t.whiteform_image}`)})}),e.jsx("td",{className:"px-3 py-2 align-middle text-center",children:e.jsx("span",{className:y(t.status),children:t.status||"Pending"})}),e.jsxs("td",{className:"px-3 py-2 align-middle text-center space-x-2",children:[(!t.status||"Pending"===t.status)&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn-blue-glow disabled:opacity-50 disabled:cursor-not-allowed transition-opacity duration-200 mr-2",onClick:()=>j(t.id,t.email,"approved"),disabled:p,children:p&&u.playerId===t.id&&"approved"===u.action?"Processing...":"Approve"}),e.jsx("button",{className:"btn-blue-glow disabled:opacity-50 disabled:cursor-not-allowed transition-opacity duration-200",onClick:()=>j(t.id,t.email,"disapproved"),disabled:p,children:p&&u.playerId===t.id&&"disapproved"===u.action?"Processing...":"Disapprove"})]}),t.status&&"Pending"!==t.status&&t.statusUpdatedAt&&new Date-new Date(t.statusUpdatedAt)<1e4&&e.jsxs("button",{className:"bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-1 px-3 rounded text-sm transition-colors ml-2",onClick:()=>{m(e=>e.map(e=>({...e,players:e.players.map(e=>e.id===t.id?{...e,status:"Pending"}:e)})))},children:["Undo ",t.status]}),t.status&&"Pending"!==t.status&&(!t.statusUpdatedAt||new Date-new Date(t.statusUpdatedAt)>=1e4)&&e.jsx("span",{className:"text-sm text-gray-400",children:t.status})]})]},t.id))})]})})]},t.id))})})]})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50",children:e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:d,alt:"Preview",className:"max-h-[90vh] max-w-[90vw] rounded shadow-lg"}),e.jsx("div",{className:"absolute top-2 right-2 flex gap-2",children:e.jsx("button",{className:"btn-blue-glow",onClick:()=>o(null),children:"✕ Close"})})]})}),u.isOpen&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded shadow max-w-sm w-full text-center",children:[e.jsxs("h2",{className:"text-lg font-bold mb-4",children:[u.isUndo?"Undo ":"",u.action.charAt(0).toUpperCase()+u.action.slice(1)]}),e.jsx("p",{className:"mb-4",children:u.isUndo?`Are you sure you want to undo the ${u.action} status?`:`Are you sure you want to ${u.action} this player?`}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx("button",{className:"btn-blue-glow w-full",onClick:w,disabled:p,children:"Cancel"}),e.jsx("button",{className:"btn-blue-glow w-full",onClick:()=>{if(!u.playerId)return;const e=u.playerId,t=u.action,s=c.map(s=>{const a=s.players.findIndex(t=>t.id===e);if(-1===a)return s;const l=[...s.players];return l[a]={...l[a],status:t,previousStatus:l[a].status||"Pending",statusUpdatedAt:(new Date).toISOString()},{...s,players:l}});m(s),w();const a=setTimeout(()=>{m(s=>s.map(s=>({...s,players:s.players.map(s=>s.id===e&&s.status===t?(()=>{const{previousStatus:e,statusUpdatedAt:t,...a}=s;return a})():s)})))},1e4);return l.post(route("player.updateStatus"),{player_id:e,status:t,email:u.playerEmail},{onError:t=>{m(t=>t.map(t=>({...t,players:t.players.map(t=>t.id===e?{...t,status:t.previousStatus||"Pending"}:t)}))),alert("Failed to update status. Please try again.")},preserveScroll:!0,preserveState:!0}),()=>clearTimeout(a)},disabled:p,children:u.action.charAt(0).toUpperCase()+u.action.slice(1)})]})]})})]})}export{r as default};
